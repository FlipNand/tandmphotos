<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Wedding Photo Upload</title>
<style>
  body { font-family: sans-serif; text-align:center; padding:2rem; }
  input, button { font-size:1rem; margin:.5rem; padding:.5rem; }
  img.preview { max-width:150px; margin-top:1rem; border-radius:6px; }
</style>
</head>
<body>
  <h1>üíç Upload Your Wedding Photo</h1>
  <p>Pick a photo and tap Upload ‚Äî no login needed.</p>
  <input type="file" id="fileInput" accept="image/*" capture="environment" />
  <br><button id="uploadBtn">Upload</button>
  <p id="status"></p>
  <div id="preview"></div>

  <script>
    const UPLOAD_URL = "https://weddingphoto.arifsteinberg.workers.dev/"; // ‚Üê replace this

    const input = document.getElementById("fileInput");
    const preview = document.getElementById("preview");
    const status = document.getElementById("status");

    input.addEventListener("change", () => {
      preview.innerHTML = "";
      const f = input.files[0];
      if (f) {
        const img = document.createElement("img");
        img.className = "preview";
        img.src = URL.createObjectURL(f);
        preview.appendChild(img);
      }
    });

    document.getElementById("uploadBtn").addEventListener("click", async () => {
      const file = input.files[0];
      if (!file) return alert("Pick a photo first.");

      status.textContent = "Reading file...";
      const reader = new FileReader();

      reader.onloadend = async () => {
        const base64data = reader.result.split(",")[1];
        const filename = Date.now() + "-" + file.name.replace(/\s+/g, "_");
        status.textContent = "Uploading...";

        try {
          const res = await fetch(UPLOAD_URL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ filename, base64data })
          });
          const text = await res.text();
          status.textContent = text;
        } catch (e) {
          status.textContent = "‚ùå Upload failed: " + e.message;
        }
      };

      reader.readAsDataURL(file);
    });
  </script>
</body>
</html>
